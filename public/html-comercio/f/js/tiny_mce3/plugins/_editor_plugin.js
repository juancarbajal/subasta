(function(){function getUploadedImages(ed){var tmpCurrentImages=[];$("#imageUploader .imgArea").each(function(i){var imgInput=$(this).find("input:hidden[name^=foto]");var imgElement=$(this).find("img");if(imgInput.val()!="0"&&imgElement.length>0){tmpCurrentImages.push({id:imgInput.val(),src:imgElement.attr("src")})}});ed.currentImages=tmpCurrentImages}tinymce.create('tinymce.plugins.AdvancedImagePlugin',{init:function(ed,url){ed.addCommand('mceAdvImage',function(){getUploadedImages(ed);if(ed.dom.getAttrib(ed.selection.getNode(),'class').indexOf('mceItem')!=-1)return;ed.windowManager.open({file:url+'/image.htm',width:530+parseInt(ed.getLang('advimage.delta_width',0)),height:420+parseInt(ed.getLang('advimage.delta_height',0)),inline:1},{plugin_url:url})});ed.addButton('image',{title:'advimage.image_desc',cmd:'mceAdvImage'});ed.addCommand('mceAdvImageEraseById',function(ui,v){ed.dom.remove(v)})},getInfo:function(){return{longname:'Advanced image',author:'Moxiecode Systems AB & Erik Porroa',authorurl:'http://tinymce.moxiecode.com',infourl:'http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advimage',version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add('advimage',tinymce.plugins.AdvancedImagePlugin)})();