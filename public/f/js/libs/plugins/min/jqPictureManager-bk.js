(function(b){var a={defaults:function(){var c={frm:"#frm_add",parentRight:".fielset-content-right",parentLeft:".fielset-content-left",itemFav:".item-fav",itemDel:".item-del",itemEdit:".item-edit",sender:"#send",id:"ids_hidden_ad",img:"imgs_hidden_ad",attributeLeft:"lang",attributeRight:"id",info:true,current:0,edit:true,zIndexEffect:"1000",timeEffect:800,inputType:"hidden",separator:"_",arrowLeft:".left",arrowRight:".right"};c.isIE=!b.support.opacity&&!b.support.style;c.isIE6=c.isIE&&!window.XMLHttpRequest;return c},update:function(e){var c=b.fn.pictureManager("ids",e).split(e.separator);if(e.current!=0&&e.current==c[0]){b.fn.pictureManager("setMainPicture",e,c[1],b("#"+c[1]).children("a").children("img").attr("src"))}var f=b(e.parentRight).children("div").length;if(f<1){b(e.parentLeft).children("a").children("img").attr("src","");b(e.parentLeft).fadeOut(250)}else{b.fn.pictureManager("setMainPicture",e,c[0],b("#"+c[0]).children("a").children("img").attr("src"))}var d=b.fn.pictureManager("ids",e);var g=b.fn.pictureManager("imgs",e);if(b("#"+e.id).length==0){b(e.frm).append('<input class="'+e.id+'" id="'+e.id+'" name="'+e.id+'" type="'+e.inputType+'" value="'+d+'"></input>');b(e.frm).append('<input class="'+e.img+'" id="'+e.img+'" name="'+e.img+'" type="'+e.inputType+'" value="'+g+'"></input>')}else{b("#"+e.id).val(d);b("#"+e.img).val(g)}},setMainPicture:function(c,e,d){b(c.parentLeft).children("a").children("img").attr("src",d);b(c.parentLeft).children("a").attr(c.attributeLeft,e);b(c.parentLeft).children("p").html(b("#"+e).children("p").html());b(c.parentLeft).fadeIn(250)},ids:function(d){var c="";b.each(b(d.parentRight).children("div"),function(e,f){c+=b(f).attr(d.attributeRight)+d.separator});c=c.substr(0,(c.length-1));return c},imgs:function(c){var d="";b.each(b(c.parentRight).children("div"),function(e,f){d+=b(f).children("p").html()+c.separator});d=d.substr(0,(d.length-1));return d},init:function(c){var d=b.extend({},b.fn.pictureManager("defaults"),c);b(d.parentRight).css("position","relative");b.fn.pictureManager("update",d);b(d.parentRight).change(function(){b.fn.pictureManager("update",d)});b(d.itemFav+" a").live("click",function(g){var h=b(this).parent().parent().parent().attr(d.attributeRight);var f=b(this).parent().parent().siblings("a").children("img").attr("src");var k=b(this).parent().parent().parent().parent();var j=b(this).parent().parent().parent().position();var i=k.css("paddingLeft")+k.css("marginLeft");var m=k.css("paddingRight")+k.css("marginRight");var l=k.css("paddingTop")+k.css("marginTop");var e=k.css("paddingBottom")+k.css("marginBottom");b(this).parent().parent().parent().css({"z-index":d.zIndexEffect}).animate({top:-((j.top)-parseInt(l)),left:-((j.left)-parseInt(i))},d.timeEffect,function(){b(d.parentRight).prepend(b("#"+h).css({position:"","z-index":"",top:"",left:""}));b.fn.pictureManager("setMainPicture",d,h,f);b.fn.pictureManager("update",d)})});b(d.itemDel+" a").live("click",function(g){var f=b(this);d.current=f.parent().parent().parent().attr(d.attributeRight);var e=f.parent().parent().parent().attr(d.attributeRight);if(e!=""){b.fancybox('<div class="message-modal"><div class="title-gen"><h3 class="title-step"><span class="icon-right"></span><p>Mensaje</p></h3></div><p>Â¿Desea elimnar la imagen?</p><div class="control-group"><p class="btn-options"><button type="button" id="delete-img-picture" class="btn-standar" name="continuar"><span>Continuar</span></button><a init-value="&lt;span&gt;Cancelar&lt;/span&gt;" value="&lt;span&gt;Cancelar&lt;/span&gt;" class="btn-finish" name="cancel" href="javascript:;" id="cancel-img-picture"><span>Cancelar</span></a></p></div></div>');b("#cancel-img-picture").bind("click",function(){b.fancybox.close()});b("#delete-img-picture").bind("click",function(){b.fancybox.close();b.ajax({url:d.url_del+e,beforeSend:function(){b(".options-image .third-columm").append('<img id="loader-photo" src="'+yOSON.baseHost+'f/img/loaderKotear.gif" style="width:20px;height:20px;float:right;margin-left:0px">')},success:function(h){var j=b.parseJSON(h);if(j.code==1){if(d.info==true){b(".options-image .third-columm #loader-photo").fadeOut("slow",function(){b(this).remove()})}f.parent().parent().parent().fadeOut("slow").remove();b.fn.pictureManager("update",d);var i=b(".fielset-content-right").children().length;if(i<=_cantImg){b("#addProductImage").removeAttr("disabled")}}else{if(d.info==true){}}deleteImg=0}})})}});b(d.parentRight).sortable({revert:false,stop:function(f,g){var e=b.fn.pictureManager("ids",d).split(d.separator);if(b(d.parentLeft).children("a").attr(d.attributeLeft)!=e[0]){b.fn.pictureManager("setMainPicture",d,e[0],b("#"+e[0]).children("a").children("img").attr("src"))}b(d.parentRight).trigger("change")}});b(d.parentRight).disableSelection();b("a"+d.arrowLeft).live("click",function(g){var m=b(this).parent().parent().parent();var k=m.css("paddingLeft")+m.css("marginLeft");var o=m.css("paddingRight")+m.css("marginRight");var n=m.css("paddingTop")+m.css("marginTop");var f=m.css("paddingBottom")+m.css("marginBottom");var p=b(this).parent().parent();var h=p.attr(d.attributeRight);var e=p.children("a").children("img").attr("src");var l=p.position();var i=p.prev();var j=i.position();p.prev().before(p);b.fn.pictureManager("update",d)});b("a"+d.arrowRight).live("click",function(e){var f=b(this).parent().parent();f.next().after(f);b.fn.pictureManager("update",d)})},destroy:function(c){}};b.fn.pictureManager=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.pictureManager")}}}})(jQuery);