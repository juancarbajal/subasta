(function(b){var a={defaults:function(){var c={frm:"#frm_add",parentRight:".fielset-content-right",parentLeft:".fielset-content-left",itemFav:".item-fav",itemDel:".item-del",itemEdit:".item-edit",sender:"#send",id:"ids_hidden_ad",img:"imgs_hidden_ad",attributeLeft:"lang",attributeRight:"id",info:true,current:0,edit:true,favorite:true,del:true,zIndexEffect:"1000",timeEffect:800,inputType:"hidden",separator:",",childrens:0,limit:0,isLimit:false,defaultImage:"",onLimit:function(d){},outLimit:function(d){},favoriteImage:function(){},editImage:function(){},deleteImage:function(){}};c.isIE=!b.support.opacity&&!b.support.style;c.isIE6=c.isIE&&!window.XMLHttpRequest;return c},childrensLength:function(c){if(c.isLimit==false){if(c.childrens==c.limit){c.isLimit=true;c.onLimit(c.childrens)}}else{if(c.childrens==(c.limit-1)){c.isLimit=false;c.outLimit(c.childrens)}}},update:function(e){var c=b.fn.pictureManager("ids",e).split(e.separator);if(e.current!=0&&e.current==c[0]){b.fn.pictureManager("setMainPicture",e,c[1],b("#"+c[1]).children("a").children("img").attr("src"))}e.childrens=b(e.parentRight).children("div").length;if(e.childrens<1){b(e.parentLeft).children("a").children("img").attr("src",e.defaultImage);b(e.parentLeft).fadeOut(250);b.fn.pictureManager("childrensLength",e)}else{b.fn.pictureManager("setMainPicture",e,c[0],b("#"+c[0]).children("a").children("img").attr("src"));b.fn.pictureManager("childrensLength",e)}var d=b.fn.pictureManager("ids",e);var f=b.fn.pictureManager("imgs",e);if(b("#"+e.id).length==0){b(e.frm).append('<input id="'+e.id+'" name="'+e.id+'" type="'+e.inputType+'" value="'+d+'"></input>');b(e.frm).append('<input id="'+e.img+'" name="'+e.img+'" type="'+e.inputType+'" value="'+f+'"></input>')}else{b("#"+e.id).val(d);b("#"+e.img).val(f)}},setMainPicture:function(c,e,d){b(c.parentLeft).children("a").children("img").attr("src",d);b(c.parentLeft).children("a").attr(c.attributeLeft,e);b(c.parentLeft).children("p").html(b("#"+e).children("p").html());b(c.parentLeft).fadeIn(250)},ids:function(d){var c="";b.each(b(d.parentRight).children("div"),function(e,f){c+=b(f).attr(d.attributeRight)+d.separator});c=c.substr(0,(c.length-1));return c},imgs:function(c){var d="";b.each(b(c.parentRight).children("div"),function(e,f){d+=b(f).children("p").html()+c.separator});d=d.substr(0,(d.length-1));return d},init:function(c){var d=b.extend({},b.fn.pictureManager("defaults"),c);b(d.parentRight).css("position","relative");b.fn.pictureManager("update",d);b(d.parentRight).change(function(){b.fn.pictureManager("update",d)});if(d.favorite==true){b(d.itemFav+" a").live("click",function(g){var h=b(this).parent().parent().parent().attr(d.attributeRight);var f=b(this).parent().parent().siblings("a").children("img").attr("src");var k=b(this).parent().parent().parent().parent();var j=b(this).parent().parent().parent().position();var i=k.css("paddingLeft")+k.css("marginLeft");var m=k.css("paddingRight")+k.css("marginRight");var l=k.css("paddingTop")+k.css("marginTop");var e=k.css("paddingBottom")+k.css("marginBottom");b(this).parent().parent().parent().css({"z-index":d.zIndexEffect}).animate({top:-((j.top)-parseInt(l)),left:-((j.left)-parseInt(i))},d.timeEffect,function(){b(d.parentRight).prepend(b("#"+h).css({position:"","z-index":"",top:"",left:""}));b.fn.pictureManager("setMainPicture",d,h,f);b.fn.pictureManager("update",d)})})}else{d.favoriteImage(d)}if(d.del==true){b(d.itemDel+" a").live("click",function(g){var f=b(this);d.current=f.parent().parent().parent().attr(d.attributeRight);var e=f.parent().parent().parent().attr(d.attributeRight);if(e!=""){b.ajax({url:d.url_del+e,success:function(h){var i=b.parseJSON(h);if(i.code==1){if(d.info==true){if(i.msg!=""){}}f.parent().parent().parent().remove();b.fn.pictureManager("update",d)}else{if(d.info==true){if(i.msg!=""){}}}}})}})}else{d.deleteImage(d)}if(d.edit==true){b(d.itemEdit+" a").live("click",function(e){})}else{d.editImage(d)}b(d.parentRight).sortable({revert:false,stop:function(f,g){var e=b.fn.pictureManager("ids",d).split(d.separator);if(b(d.parentLeft).children("a").attr(d.attributeLeft)!=e[0]){b.fn.pictureManager("setMainPicture",d,e[0],b("#"+e[0]).children("a").children("img").attr("src"))}b(d.parentRight).trigger("change")}});b(d.parentRight).disableSelection()},destroy:function(c){}};b.fn.pictureManager=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.pictureManager")}}}})(jQuery);