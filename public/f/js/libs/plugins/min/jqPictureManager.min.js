(function(c){var d={defaults:function(){var a={frm:"#frm_add",parentRight:".fielset-content-right",parentLeft:".fielset-content-left",itemFav:".item-fav",itemDel:".item-del",itemEdit:".item-edit",sender:"#send",id:"ids",img:"imgs",attributeLeft:"lang",attributeRight:"id",info:true,current:0,edit:true,zIndexEffect:"1000",timeEffect:800,inputType:"hidden",separator:",",childrens:0,limit:0,isLimit:false,defaultImage:"",onLimit:function(b){},outLimit:function(b){}};a.isIE=!c.support.opacity&&!c.support.style;a.isIE6=a.isIE&&!window.XMLHttpRequest;return a},childrensLength:function(a){if(a.isLimit==false){if(a.childrens==a.limit){a.isLimit=true;a.onLimit(a.childrens)}}else{if(a.childrens==(a.limit-1)){a.isLimit=false;a.outLimit(a.childrens)}}},update:function(b){var h=c.fn.pictureManager("ids",b).split(b.separator);if(b.current!=0&&b.current==h[0]){c.fn.pictureManager("setMainPicture",b,h[1],c("#"+h[1]).children("a").children("img").attr("src"))}b.childrens=c(b.parentRight).children("div").length;if(b.childrens<1){c(b.parentLeft).children("a").children("img").attr("src",b.defaultImage);c(b.parentLeft).fadeOut(250);c.fn.pictureManager("childrensLength",b)}else{c.fn.pictureManager("setMainPicture",b,h[0],c("#"+h[0]).children("a").children("img").attr("src"));c.fn.pictureManager("childrensLength",b)}var g=c.fn.pictureManager("ids",b);var a=c.fn.pictureManager("imgs",b);if(c("#"+b.id).length==0){c(b.frm).append('<input id="'+b.id+'" name="'+b.id+'" type="'+b.inputType+'" value="'+g+'"></input>');c(b.frm).append('<input id="'+b.img+'" name="'+b.img+'" type="'+b.inputType+'" value="'+a+'"></input>')}else{c("#"+b.id).val(g);c("#"+b.img).val(a)}},setMainPicture:function(f,a,b){c(f.parentLeft).children("a").children("img").attr("src",b);c(f.parentLeft).children("a").attr(f.attributeLeft,a);c(f.parentLeft).children("p").html(c("#"+a).children("p").html());c(f.parentLeft).fadeIn(250)},ids:function(a){var b="";c.each(c(a.parentRight).children("div"),function(h,g){b+=c(g).attr(a.attributeRight)+a.separator});b=b.substr(0,(b.length-1));return b},imgs:function(b){var a="";c.each(c(b.parentRight).children("div"),function(h,g){a+=c(g).children("p").html()+b.separator});a=a.substr(0,(a.length-1));return a},init:function(b){var a=c.extend({},c.fn.pictureManager("defaults"),b);c(a.parentRight).css("position","relative");c.fn.pictureManager("update",a);c(a.parentRight).change(function(){c.fn.pictureManager("update",a)});c(a.itemFav+" a").live("click",function(t){var s=c(this).parent().parent().parent().attr(a.attributeRight);var u=c(this).parent().parent().siblings("a").children("img").attr("src");var p=c(this).parent().parent().parent().parent();var q=c(this).parent().parent().parent().position();var r=p.css("paddingLeft")+p.css("marginLeft");var n=p.css("paddingRight")+p.css("marginRight");var o=p.css("paddingTop")+p.css("marginTop");var v=p.css("paddingBottom")+p.css("marginBottom");c(this).parent().parent().parent().css({"z-index":a.zIndexEffect}).animate({top:-((q.top)-parseInt(o)),left:-((q.left)-parseInt(r))},a.timeEffect,function(){c(a.parentRight).prepend(c("#"+s).css({position:"","z-index":"",top:"",left:""}));c.fn.pictureManager("setMainPicture",a,s,u);c.fn.pictureManager("update",a)})});c(a.itemDel+" a").live("click",function(h){var i=c(this);a.current=i.parent().parent().parent().attr(a.attributeRight);var j=i.parent().parent().parent().attr(a.attributeRight);if(j!=""){c.ajax({url:a.url_del+j,success:function(f){var e=c.parseJSON(f);Console.log(e);if(e.code==1){if(a.info==true){c.fn.consola({msg:e.msg,mode:"info",lifetime:1500})}i.parent().parent().parent().remove();c.fn.pictureManager("update",a)}else{if(a.info==true){c.fn.consola({msg:e.msg,mode:"info",lifetime:2500})}}}})}});c(a.parentRight).sortable({revert:false,stop:function(i,h){var j=c.fn.pictureManager("ids",a).split(a.separator);if(c(a.parentLeft).children("a").attr(a.attributeLeft)!=j[0]){c.fn.pictureManager("setMainPicture",a,j[0],c("#"+j[0]).children("a").children("img").attr("src"))}c(a.parentRight).trigger("change")}});c(a.parentRight).disableSelection()},destroy:function(a){}};c.fn.pictureManager=function(a){if(d[a]){return d[a].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof a==="object"||!a){return d.init.apply(this,arguments)}else{c.error("Method "+a+" does not exist on jQuery.pictureManager")}}}})(jQuery);